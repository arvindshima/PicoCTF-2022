# picoCTF 2022

> Arvind Shima | March 19,2022

## Overview

| Tables | Description |
| ------ | ----------- |
| Category | Cryptography |
| Challenge Name | Sum-O-Primes |
| Points | 400 |

## Description

We have so much faith in RSA we give you not just the product of the primes, but their sum as well!

#### gen.py

```python
#!/usr/bin/python

from binascii import hexlify
from gmpy2 import mpz_urandomb, next_prime, random_state
import math
import os
import sys

if sys.version_info < (3, 9):
    import gmpy2
    math.gcd = gmpy2.gcd
    math.lcm = gmpy2.lcm

FLAG  = open('flag.txt').read().strip()
FLAG  = int(hexlify(FLAG.encode()), 16)
SEED  = int(hexlify(os.urandom(32)).decode(), 16)
STATE = random_state(SEED)

def get_prime(bits):
    return next_prime(mpz_urandomb(STATE, bits) | (1 << (bits - 1)))

p = get_prime(1024)
q = get_prime(1024)

x = p + q
n = p * q

e = 65537

m = math.lcm(p - 1, q - 1)
d = pow(e, -1, m)

c = pow(FLAG, e, n)

print(f'x = {x:x}')
print(f'n = {n:x}')
print(f'c = {c:x}')
```

#### output.txt

```
x = 17fef88f46a58da13be8083b814caf6cd8d494dd6c21ad7bf399e521e14466d51a74f51ad5499731018b6a437576e72bd397c4bb07bfbb699c1a35f1f4fa1b86dee2a1702670e9cea45aa7062f9569279d6d4b964f3df2ff8e38cf029faad57e42b831bde21132303e127cba4e80cd3c9ff6a7bad5b399a18252dc35460471ea8
n = 85393637a04ec36e699796ac16979c51ecea41cfd8353c2a241193d1d40d02701b34e9cd4deaf2b13b6717757f178ff75249f3d675448ec928aef41c39e4be1c8ba2ba79c4ada36c607763d7dc8543103acfe1027245acda2208f22fcabe0f37bdadf077e4f943c4f4178cedeb5279a4ebc86323356e23a58b6666ac6ffbf4f1c8229117ffb9071a94dfb724957f10d6664e4ee02e16bed29eb922f126e2082e2f73b5c5b7817e0543155eb9673f4de3de8c91707c1261e8ba6e7348d930293f7796679218c2b1dabe41527eccd72ec3e7284344622eff81ae0541769fb70b6146b54bd092c2dfbe7f8e9653cad80d0fb4f3ef288778927b3852f9ff3a4076d7
c = 42cafbc77ed8396a681dac328701ee02cd746488ae084f15a3e6a5b8f666c595a372a69bbca0dae934fd5ed2292d4393912ee10a22a3b57de9cee2f30b5dc7c67f574b0453f6074171cca37bd407529cb30ba17f152ef5b2484d94b38cf0a513a723255d725e5c3b3f3c985f9223095be3fa148afedf91e4ed37720c3d97dd29cf07830efa8a557a9da68d3095fc3b31f3763e030b62c70d94c3d2951e163e48683f3b9611d562ea06bf1e5d8465e8bf5a6345050a5e7b0c175faf136562cf2a196fdb61ac6503446616cffa9ed85015b86dda73f6eda4d688d3e719a07439d98f95fb5dcf675948ec58d9af83fa29afa4375213ec48f09a6c8cbc431cfe7c6a
```

#### Hint

- I love squares :)

## Approach

Checked out the code and Looked for How its created? Then I saw the output.txt, All we know it's a RSA Cipher which have the value of `n (modulus)` and `c (ciphertext)` were present in hexadecimal. So, Let's change those all to integer and We have value of `e (public exponent)` in our code. Let's decode the ciphertext by using [RsaCtfTool](https://github.com/Ganapati/RsaCtfTool).

```
n = 16817906743787117568271213139861972515484825710697502362612278243606774929534186692174232165514115410892537289341632591087978727636980649571114896455612349837611505054660545102326338341389566329477540905795304086025083540034061839374074587235232557404832224235438607341623982272274216484614162696421931223838897647603078596811270720011789141042790195022093968293439238624576349519197341421638802686113129798369902166062163858098862695839428848815061935831887602571412970816862390963537403093245360735286120042891683778351900342884298209821027781291903979336460775767456365306819237425220740207098368507270214598031063

e = 65537

c = 8431823028514299273947171530623485341280072822536852972587126428390269523786542425546157204850174266761303045380907984303023491253375249622007135297544793254399604754046217002853631818868187796960739513080686587267918492830293252653614682691601677117296878262391205787062587537613611300986878116108551690089843400676474017817086382240850419141634417958423995354852110938131725240797121033163880314298259370469740601921394024140624346645640337311297685635528476322779791103331134895286927451442282583429564840092444238735686981562028344903880207297613762606346199422982700278349114959900619663642399919316760134581354
```

```bash
python3 RsaCtfTool.py -n 16817906743787117568271213139861972515484825710697502362612278243606774929534186692174232165514115410892537289341632591087978727636980649571114896455612349837611505054660545102326338341389566329477540905795304086025083540034061839374074587235232557404832224235438607341623982272274216484614162696421931223838897647603078596811270720011789141042790195022093968293439238624576349519197341421638802686113129798369902166062163858098862695839428848815061935831887602571412970816862390963537403093245360735286120042891683778351900342884298209821027781291903979336460775767456365306819237425220740207098368507270214598031063 -e 65537 --uncipher 8431823028514299273947171530623485341280072822536852972587126428390269523786542425546157204850174266761303045380907984303023491253375249622007135297544793254399604754046217002853631818868187796960739513080686587267918492830293252653614682691601677117296878262391205787062587537613611300986878116108551690089843400676474017817086382240850419141634417958423995354852110938131725240797121033163880314298259370469740601921394024140624346645640337311297685635528476322779791103331134895286927451442282583429564840092444238735686981562028344903880207297613762606346199422982700278349114959900619663642399919316760134581354
```

## Flag

```
picoCTF{3921def5}
```
